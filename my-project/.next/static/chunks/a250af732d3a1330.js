(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99898,e=>{"use strict";var s=e.i(43476),t=e.i(932),l=e.i(71645),a=e.i(18566);let r=[{id:1,title:"Bega riverside plastic cleanup",desc:"Gathered PET bottles and cans along the river.",date:"2025-11-10",bags:4,pos:{lat:45.7489,lng:21.229}},{id:2,title:"Neighborhood park trash sweep",desc:"Cleaned snack wrappers and cigarette butts around benches.",date:"2025-11-05",bags:3,pos:{lat:45.7545,lng:21.22}},{id:3,title:"Street-side bottle collection",desc:"Focused on glass bottles near the tram station.",date:"2025-11-01",bags:2,pos:{lat:45.742,lng:21.24}},{id:4,title:"Green area micro-cleanup",desc:"Removed mixed waste from a small green strip.",date:"2025-10-28",bags:1,pos:{lat:45.761,lng:21.205}}],n=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],i=[3,6,2,5,4,7,6];function d(){let e=(0,a.useRouter)(),[t,n]=(0,l.useState)(null),[i,d]=(0,l.useState)(!0),[x,m]=(0,l.useState)(!1),[p,h]=(0,l.useState)(null),[u,g]=(0,l.useState)(null),[j,f]=(0,l.useState)(""),[v,y]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/profile"),s=await e.json();s.user&&(n(s.user),f(s.user.username||""),y(s.user.avatarUrl||""))}catch(e){console.error("Error loading profile:",e),h("Failed to load profile.")}finally{d(!1)}})()},[]);let N=async()=>{if(t){m(!0),h(null),g(null);try{let e=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:j.trim()||null,avatarUrl:v.trim()||null})}),s=await e.json();e.ok?s.user&&(n(s.user),g("Profile saved successfully.")):h(s.error||"Failed to save profile.")}catch(e){console.error("Error saving profile:",e),h("Something went wrong while saving.")}finally{m(!1),setTimeout(()=>g(null),2500)}}},w=t?.username||t?.email?.split("@")[0]||"Eco Explorer",k=t?.username?`@${t.username}`:t?.email?`@${t.email.split("@")[0]}`:"@eco.explorer",S=t?.avatarUrl&&t.avatarUrl.length>0?t.avatarUrl:"/images/rafa.jpg",T=t?.points??0;return i?(0,s.jsx)("div",{className:"min-h-screen bg-[#020617] text-white flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-sm text-gray-300",children:"Loading profileâ€¦"})}):t?(0,s.jsx)("div",{className:"min-h-screen bg-[#020617] text-white px-6 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Profile"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Track your cleanup impact, badges and latest missions on the map."})]}),(0,s.jsxs)("button",{onClick:()=>e.back(),className:" self-start sm:self-auto inline-flex items-center gap-2 px-4 py-2 rounded-full text-xs font-semibold bg-[#020617] border border-emerald-500/50 text-emerald-200 hover:bg-emerald-600/10 hover:border-emerald-400 transition ",children:[(0,s.jsx)("span",{className:"text-sm",children:"â†"}),"Back to last page"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-6 lg:col-span-1",children:[(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-2xl overflow-hidden border-2 border-emerald-400 shadow-[0_0_25px_rgba(16,185,129,0.65)]",children:(0,s.jsx)("img",{src:S,alt:w,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"absolute -bottom-1 -right-1 px-2 py-0.5 rounded-full bg-emerald-500 text-[11px] font-semibold",children:["Lv. ",7]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-lg font-semibold",children:w}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:k}),(0,s.jsxs)("p",{className:"mt-2 text-xs text-emerald-400 flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-base",children:"ðŸ’Ž"}),(0,s.jsxs)("span",{className:"font-semibold",children:[T," eco points"]})]})]})]}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-3 text-center text-xs",children:[(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl py-3",children:[(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:"Global rank"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-white",children:["#",12]})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl py-3",children:[(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:"Cleanups"}),(0,s.jsx)("p",{className:"text-lg font-bold text-emerald-400",children:34})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl py-3",children:[(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:"Hours"}),(0,s.jsx)("p",{className:"text-lg font-bold text-emerald-400",children:52})]})]})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsx)("h2",{className:"text-sm font-semibold mb-3 text-gray-100",children:"Impact overview"}),(0,s.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Total bags collected"}),(0,s.jsx)("span",{className:"font-semibold text-emerald-400",children:96})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Average bags / cleanup"}),(0,s.jsx)("span",{className:"font-semibold",children:"2.8"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Average duration"}),(0,s.jsxs)("span",{className:"font-semibold",children:["1.5"," h"]})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Progress to next level"}),(0,s.jsx)("div",{className:"h-2 w-full bg-[#020617] border border-[#1e293b] rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-300 rounded-full",style:{width:"68%"}})})]})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsx)("h2",{className:"text-sm font-semibold mb-3 text-gray-100",children:"Profile settings"}),(0,s.jsxs)("div",{className:"space-y-3 text-xs",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-400 mb-1",children:"Username (public)"}),(0,s.jsx)("input",{type:"text",value:j,onChange:e=>f(e.target.value),placeholder:"Your public username",className:"w-full bg-[#020617] border border-[#1e293b] rounded-lg px-3 py-2 outline-none text-sm text-gray-100 placeholder:text-gray-500"}),(0,s.jsx)("p",{className:"mt-1 text-[11px] text-gray-500",children:"This will be shown on leaderboards and quests."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-400 mb-1",children:"Avatar image URL"}),(0,s.jsx)("input",{type:"text",value:v,onChange:e=>y(e.target.value),placeholder:"https://your-avatar-url.jpg",className:"w-full bg-[#020617] border border-[#1e293b] rounded-lg px-3 py-2 outline-none text-sm text-gray-100 placeholder:text-gray-500"}),(0,s.jsx)("p",{className:"mt-1 text-[11px] text-gray-500",children:"For now, paste a direct image URL. (Later you can add upload.)"})]}),p&&(0,s.jsx)("p",{className:"text-[11px] text-red-400 mt-1",children:p}),u&&(0,s.jsx)("p",{className:"text-[11px] text-emerald-400 mt-1",children:u}),(0,s.jsx)("button",{onClick:N,disabled:x,className:`mt-2 w-full text-center py-2.5 rounded-full text-sm font-semibold 
                    bg-emerald-600 hover:bg-emerald-500 transition 
                    disabled:opacity-50 disabled:cursor-not-allowed`,children:x?"Savingâ€¦":"Save changes"})]})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsx)("h2",{className:"text-sm font-semibold mb-3 text-gray-100",children:"Badges & achievements"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs",children:[(0,s.jsx)(b,{label:"River Guardian",desc:"5+ river cleanups",icon:"ðŸŒŠ"}),(0,s.jsx)(b,{label:"Bottle Hunter",desc:"200+ bottles collected",icon:"ðŸ§´"}),(0,s.jsx)(b,{label:"Weekend Warrior",desc:"Active 4 weekends in a row",icon:"ðŸ“…"}),(0,s.jsx)(b,{label:"Early Supporter",desc:"Joined in beta",icon:"â­"})]})]})]}),(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Last cleanup locations"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"A quick overview of your most recent cleanup spots."})]}),(0,s.jsxs)("span",{className:"text-[11px] px-2 py-1 rounded-full bg-emerald-500/10 text-emerald-300 border border-emerald-500/40",children:[r.length," locations"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4",children:[(0,s.jsx)("div",{className:"xl:col-span-2",children:(0,s.jsx)(c,{cleanups:r})}),(0,s.jsx)("div",{className:"space-y-3 max-h-[260px] overflow-y-auto pr-1",children:r.map(e=>(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl px-3 py-3 text-xs hover:border-emerald-500/70 hover:bg-[#020617]/60 transition",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-[13px]",children:e.title}),(0,s.jsx)("p",{className:"text-gray-400 mt-0.5",children:e.desc})]}),(0,s.jsx)("span",{className:"text-[11px] text-gray-500 whitespace-nowrap",children:e.date})]}),(0,s.jsxs)("div",{className:"mt-2 flex items-center justify-between text-[11px] text-gray-400",children:[(0,s.jsxs)("span",{children:["ðŸ—‘ï¸ ",e.bags," bags collected"]}),(0,s.jsxs)("span",{children:[e.pos.lat.toFixed(3),", ",e.pos.lng.toFixed(3)]})]})]},e.id))})]})]}),(0,s.jsx)(o,{})]})]})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-[#020617] text-white flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center space-y-2",children:[(0,s.jsx)("p",{className:"text-lg font-semibold",children:"Youâ€™re not logged in."}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Please log in to view your dashboard."})]})})}function c({cleanups:t}){let a=(0,l.useRef)(null),r=(0,l.useRef)(null),n=(0,l.useRef)(null),i=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let s=!0;return(async()=>{if(!a.current||r.current)return;let t=await e.A(71400);await e.A(12620);let l=t.default||t;if(i.current=l,!s)return;let d=l.map(a.current,{center:[45.7489,21.2087],zoom:12,zoomControl:!1,attributionControl:!1});l.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{maxZoom:18}).addTo(d);let c=l.layerGroup().addTo(d);r.current=d,n.current=c})(),()=>{s=!1,r.current&&(r.current.remove(),r.current=null)}},[]),(0,l.useEffect)(()=>{if(!r.current||!n.current||!i.current)return;let e=i.current;n.current.clearLayers();let s=[];if(t.forEach(t=>{let l=e.circleMarker([t.pos.lat,t.pos.lng],{radius:7,weight:2,color:"#22c55e",fillColor:"#22c55e",fillOpacity:.8});l.bindPopup(`<strong>${t.title}</strong><br/>${t.desc}<br/><small>${t.date}</small>`),l.addTo(n.current),s.push([t.pos.lat,t.pos.lng])}),s.length>0){let t=e.latLngBounds(s);r.current.fitBounds(t,{padding:[20,20]})}},[t]),(0,s.jsx)("div",{className:"w-full h-[260px] rounded-xl overflow-hidden border border-[#1e293b]",children:(0,s.jsx)("div",{ref:a,className:"w-full h-full"})})}function o(){let e,l,a,r,d=(0,t.c)(4),c=Math.max(...i),o=i.reduce(x,0)/i.length;return d[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-sm font-semibold text-gray-100",children:"Impact timeline"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Bags collected across your last 7 cleanups."})]}),(0,s.jsx)("span",{className:"text-[11px] text-gray-500",children:"Last 7 sessions"})]}),l=(0,s.jsx)(m,{data:i,labels:n}),d[0]=e,d[1]=l):(e=d[0],l=d[1]),d[2]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsxs)("span",{children:["Best session:"," ",(0,s.jsxs)("span",{className:"text-emerald-400 font-semibold",children:[c," bags"]})]}),d[2]=a):a=d[2],d[3]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[e,l,(0,s.jsxs)("div",{className:"mt-4 flex items-center justify-between text-[11px] text-gray-400",children:[a,(0,s.jsxs)("span",{children:["Average:"," ",(0,s.jsxs)("span",{className:"text-emerald-400 font-semibold",children:[o.toFixed(1)," bags"]})]})]})]}),d[3]=r):r=d[3],r}function x(e,s){return e+s}function m(e){let l,a,r,n,i,d,c,o,x,m,b,g=(0,t.c)(30),{data:j,labels:f}=e,v=Math.max(...j,1);if(g[0]!==j||g[1]!==v){let e;g[9]!==j.length||g[10]!==v?(e=(e,s)=>({x:j.length>1?260/(j.length-1)*s:130,y:80-e/v*64-8}),g[9]=j.length,g[10]=v,g[11]=e):e=g[11];let t=j.map(e),o=t.map(u).join(" "),x=o+` L${t[t.length-1]?.x??260},80 L${t[0]?.x??0},80 Z`;c="w-full",l="0 0 260 80",a="w-full h-24 overflow-visible",g[12]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"impactGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"0%",stopColor:"#22c55e",stopOpacity:"0.5"}),(0,s.jsx)("stop",{offset:"100%",stopColor:"#22c55e",stopOpacity:"0"})]})}),g[12]=r):r=g[12],g[13]!==x?(n=(0,s.jsx)("path",{d:x,fill:"url(#impactGradient)",stroke:"none",opacity:.6}),g[13]=x,g[14]=n):n=g[14],i=(0,s.jsx)("path",{d:o,fill:"none",stroke:"#22c55e",strokeWidth:2.2,strokeLinecap:"round",strokeLinejoin:"round"}),d=t.map(h),g[0]=j,g[1]=v,g[2]=l,g[3]=a,g[4]=r,g[5]=n,g[6]=i,g[7]=d,g[8]=c}else l=g[2],a=g[3],r=g[4],n=g[5],i=g[6],d=g[7],c=g[8];return g[15]!==l||g[16]!==a||g[17]!==r||g[18]!==n||g[19]!==i||g[20]!==d?(o=(0,s.jsxs)("svg",{viewBox:l,className:a,children:[r,n,i,d]}),g[15]=l,g[16]=a,g[17]=r,g[18]=n,g[19]=i,g[20]=d,g[21]=o):o=g[21],g[22]!==f?(x=f.map(p),g[22]=f,g[23]=x):x=g[23],g[24]!==x?(m=(0,s.jsx)("div",{className:"mt-1 flex justify-between text-[10px] text-gray-500",children:x}),g[24]=x,g[25]=m):m=g[25],g[26]!==m||g[27]!==c||g[28]!==o?(b=(0,s.jsxs)("div",{className:c,children:[o,m]}),g[26]=m,g[27]=c,g[28]=o,g[29]=b):b=g[29],b}function p(e){return(0,s.jsx)("span",{children:e},e)}function h(e,t){return(0,s.jsx)("circle",{cx:e.x,cy:e.y,r:3,fill:"#22c55e",stroke:"#022c22",strokeWidth:1.4},t)}function u(e,s){return`${0===s?"M":"L"}${e.x},${e.y}`}function b(e){let l,a,r,n,i,d=(0,t.c)(12),{label:c,desc:o,icon:x}=e;return d[0]!==x?(l=(0,s.jsx)("span",{className:"text-lg",children:x}),d[0]=x,d[1]=l):l=d[1],d[2]!==c?(a=(0,s.jsx)("p",{className:"font-semibold text-gray-100",children:c}),d[2]=c,d[3]=a):a=d[3],d[4]!==o?(r=(0,s.jsx)("p",{className:"text-gray-400",children:o}),d[4]=o,d[5]=r):r=d[5],d[6]!==a||d[7]!==r?(n=(0,s.jsxs)("div",{className:"text-[11px]",children:[a,r]}),d[6]=a,d[7]=r,d[8]=n):n=d[8],d[9]!==l||d[10]!==n?(i=(0,s.jsxs)("div",{className:"flex items-start gap-2 bg-[#020617] border border-[#1e293b] rounded-xl px-3 py-2",children:[l,n]}),d[9]=l,d[10]=n,d[11]=i):i=d[11],i}e.s(["default",()=>d])},71400,e=>{e.v(s=>Promise.all(["static/chunks/1442f9ddf5556540.js"].map(s=>e.l(s))).then(()=>s(32322)))},12620,e=>{e.v(s=>Promise.all(["static/chunks/92775ae1698e5da0.css"].map(s=>e.l(s))).then(()=>{}))}]);