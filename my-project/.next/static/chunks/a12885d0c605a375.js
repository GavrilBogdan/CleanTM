(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99898,e=>{"use strict";var s=e.i(43476),t=e.i(932),l=e.i(71645),a=e.i(18566),r=e.i(32322);let n=[{id:1,title:"Bega riverside plastic cleanup",desc:"Gathered PET bottles and cans along the river.",date:"2025-11-10",bags:4,pos:{lat:45.7489,lng:21.229}},{id:2,title:"Neighborhood park trash sweep",desc:"Cleaned snack wrappers and cigarette butts around benches.",date:"2025-11-05",bags:3,pos:{lat:45.7545,lng:21.22}},{id:3,title:"Street-side bottle collection",desc:"Focused on glass bottles near the tram station.",date:"2025-11-01",bags:2,pos:{lat:45.742,lng:21.24}},{id:4,title:"Green area micro-cleanup",desc:"Removed mixed waste from a small green strip.",date:"2025-10-28",bags:1,pos:{lat:45.761,lng:21.205}}],d=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],i=[3,6,2,5,4,7,6];function c(){let e=(0,a.useRouter)(),[t,r]=(0,l.useState)(null),[d,i]=(0,l.useState)(!0),[c,m]=(0,l.useState)(!1),[p,h]=(0,l.useState)(null),[u,b]=(0,l.useState)(null),[f,j]=(0,l.useState)(""),[y,v]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/profile"),s=await e.json();s.user&&(r(s.user),j(s.user.username||""),v(s.user.avatarUrl||""))}catch(e){console.error("Error loading profile:",e),h("Failed to load profile.")}finally{i(!1)}})()},[]);let N=async()=>{if(t){m(!0),h(null),b(null);try{let e=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:f.trim()||null,avatarUrl:y.trim()||null})}),s=await e.json();e.ok?s.user&&(r(s.user),b("Profile saved successfully.")):h(s.error||"Failed to save profile.")}catch(e){console.error("Error saving profile:",e),h("Something went wrong while saving.")}finally{m(!1),setTimeout(()=>b(null),2500)}}},w=t?.username||t?.email?.split("@")[0]||"Eco Explorer",k=t?.username?`@${t.username}`:t?.email?`@${t.email.split("@")[0]}`:"@eco.explorer",S=t?.avatarUrl&&t.avatarUrl.length>0?t.avatarUrl:"/images/rafa.jpg",_=t?.points??0;return d?(0,s.jsx)("div",{className:"min-h-screen bg-[#020617] text-white flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-sm text-gray-300",children:"Loading profileâ€¦"})}):t?(0,s.jsx)("div",{className:"min-h-screen bg-[#020617] text-white px-6 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Profile"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Track your cleanup impact, badges and latest missions on the map."})]}),(0,s.jsxs)("button",{onClick:()=>e.back(),className:" self-start sm:self-auto inline-flex items-center gap-2 px-4 py-2 rounded-full text-xs font-semibold bg-[#020617] border border-emerald-500/50 text-emerald-200 hover:bg-emerald-600/10 hover:border-emerald-400 transition ",children:[(0,s.jsx)("span",{className:"text-sm",children:"â†"}),"Back to last page"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-6 lg:col-span-1",children:[(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-2xl overflow-hidden border-2 border-emerald-400 shadow-[0_0_25px_rgba(16,185,129,0.65)]",children:(0,s.jsx)("img",{src:S,alt:w,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"absolute -bottom-1 -right-1 px-2 py-0.5 rounded-full bg-emerald-500 text-[11px] font-semibold",children:["Lv. ",7]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-lg font-semibold",children:w}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:k}),(0,s.jsxs)("p",{className:"mt-2 text-xs text-emerald-400 flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-base",children:"ðŸ’Ž"}),(0,s.jsxs)("span",{className:"font-semibold",children:[_," eco points"]})]})]})]}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-3 text-center text-xs",children:[(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl py-3",children:[(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:"Global rank"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-white",children:["#",12]})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl py-3",children:[(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:"Cleanups"}),(0,s.jsx)("p",{className:"text-lg font-bold text-emerald-400",children:34})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl py-3",children:[(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:"Hours"}),(0,s.jsx)("p",{className:"text-lg font-bold text-emerald-400",children:52})]})]})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsx)("h2",{className:"text-sm font-semibold mb-3 text-gray-100",children:"Impact overview"}),(0,s.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Total bags collected"}),(0,s.jsx)("span",{className:"font-semibold text-emerald-400",children:96})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Average bags / cleanup"}),(0,s.jsx)("span",{className:"font-semibold",children:"2.8"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Average duration"}),(0,s.jsxs)("span",{className:"font-semibold",children:["1.5"," h"]})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Progress to next level"}),(0,s.jsx)("div",{className:"h-2 w-full bg-[#020617] border border-[#1e293b] rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-300 rounded-full",style:{width:"68%"}})})]})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsx)("h2",{className:"text-sm font-semibold mb-3 text-gray-100",children:"Profile settings"}),(0,s.jsxs)("div",{className:"space-y-3 text-xs",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-400 mb-1",children:"Username (public)"}),(0,s.jsx)("input",{type:"text",value:f,onChange:e=>j(e.target.value),placeholder:"Your public username",className:"w-full bg-[#020617] border border-[#1e293b] rounded-lg px-3 py-2 outline-none text-sm text-gray-100 placeholder:text-gray-500"}),(0,s.jsx)("p",{className:"mt-1 text-[11px] text-gray-500",children:"This will be shown on leaderboards and quests."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-400 mb-1",children:"Avatar image URL"}),(0,s.jsx)("input",{type:"text",value:y,onChange:e=>v(e.target.value),placeholder:"https://your-avatar-url.jpg",className:"w-full bg-[#020617] border border-[#1e293b] rounded-lg px-3 py-2 outline-none text-sm text-gray-100 placeholder:text-gray-500"}),(0,s.jsx)("p",{className:"mt-1 text-[11px] text-gray-500",children:"For now, paste a direct image URL. (Later you can add upload.)"})]}),p&&(0,s.jsx)("p",{className:"text-[11px] text-red-400 mt-1",children:p}),u&&(0,s.jsx)("p",{className:"text-[11px] text-emerald-400 mt-1",children:u}),(0,s.jsx)("button",{onClick:N,disabled:c,className:`mt-2 w-full text-center py-2.5 rounded-full text-sm font-semibold 
                    bg-emerald-600 hover:bg-emerald-500 transition 
                    disabled:opacity-50 disabled:cursor-not-allowed`,children:c?"Savingâ€¦":"Save changes"})]})]}),(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsx)("h2",{className:"text-sm font-semibold mb-3 text-gray-100",children:"Badges & achievements"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs",children:[(0,s.jsx)(g,{label:"River Guardian",desc:"5+ river cleanups",icon:"ðŸŒŠ"}),(0,s.jsx)(g,{label:"Bottle Hunter",desc:"200+ bottles collected",icon:"ðŸ§´"}),(0,s.jsx)(g,{label:"Weekend Warrior",desc:"Active 4 weekends in a row",icon:"ðŸ“…"}),(0,s.jsx)(g,{label:"Early Supporter",desc:"Joined in beta",icon:"â­"})]})]})]}),(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Last cleanup locations"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"A quick overview of your most recent cleanup spots."})]}),(0,s.jsxs)("span",{className:"text-[11px] px-2 py-1 rounded-full bg-emerald-500/10 text-emerald-300 border border-emerald-500/40",children:[n.length," locations"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4",children:[(0,s.jsx)("div",{className:"xl:col-span-2",children:(0,s.jsx)(o,{cleanups:n})}),(0,s.jsx)("div",{className:"space-y-3 max-h-[260px] overflow-y-auto pr-1",children:n.map(e=>(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl px-3 py-3 text-xs hover:border-emerald-500/70 hover:bg-[#020617]/60 transition",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-[13px]",children:e.title}),(0,s.jsx)("p",{className:"text-gray-400 mt-0.5",children:e.desc})]}),(0,s.jsx)("span",{className:"text-[11px] text-gray-500 whitespace-nowrap",children:e.date})]}),(0,s.jsxs)("div",{className:"mt-2 flex items-center justify-between text-[11px] text-gray-400",children:[(0,s.jsxs)("span",{children:["ðŸ—‘ï¸ ",e.bags," bags collected"]}),(0,s.jsxs)("span",{children:[e.pos.lat.toFixed(3),", ",e.pos.lng.toFixed(3)]})]})]},e.id))})]})]}),(0,s.jsx)(x,{})]})]})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-[#020617] text-white flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center space-y-2",children:[(0,s.jsx)("p",{className:"text-lg font-semibold",children:"Youâ€™re not logged in."}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Please log in to view your dashboard."})]})})}function o(e){let a,n,d,i,c,o=(0,t.c)(6),{cleanups:x}=e,m=(0,l.useRef)(null),p=(0,l.useRef)(null),h=(0,l.useRef)(null);return o[0]===Symbol.for("react.memo_cache_sentinel")?(a=()=>{if(!m.current||p.current)return;let e=r.default.map(m.current,{center:[45.7489,21.2087],zoom:12,zoomControl:!1,attributionControl:!1});r.default.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{maxZoom:18}).addTo(e);let s=r.default.layerGroup().addTo(e);p.current=e,h.current=s},n=[],o[0]=a,o[1]=n):(a=o[0],n=o[1]),(0,l.useEffect)(a,n),o[2]!==x?(d=()=>{if(!p.current||!h.current)return;h.current.clearLayers();let e=[];if(x.forEach(s=>{let t=r.default.circleMarker([s.pos.lat,s.pos.lng],{radius:7,weight:2,color:"#22c55e",fillColor:"#22c55e",fillOpacity:.8});t.bindPopup(`<strong>${s.title}</strong><br/>${s.desc}<br/><small>${s.date}</small>`),t.addTo(h.current),e.push([s.pos.lat,s.pos.lng])}),e.length>0){let s=r.default.latLngBounds(e);p.current.fitBounds(s,{padding:[20,20]})}return()=>{h.current?.clearLayers()}},i=[x],o[2]=x,o[3]=d,o[4]=i):(d=o[3],i=o[4]),(0,l.useEffect)(d,i),o[5]===Symbol.for("react.memo_cache_sentinel")?(c=(0,s.jsx)("div",{className:"w-full h-[260px] rounded-xl overflow-hidden border border-[#1e293b]",children:(0,s.jsx)("div",{ref:m,className:"w-full h-full"})}),o[5]=c):c=o[5],c}function x(){let e,l,a,r,n=(0,t.c)(4),c=Math.max(...i),o=i.reduce(m,0)/i.length;return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-sm font-semibold text-gray-100",children:"Impact timeline"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Bags collected across your last 7 cleanups."})]}),(0,s.jsx)("span",{className:"text-[11px] text-gray-500",children:"Last 7 sessions"})]}),l=(0,s.jsx)(p,{data:i,labels:d}),n[0]=e,n[1]=l):(e=n[0],l=n[1]),n[2]===Symbol.for("react.memo_cache_sentinel")?(a=(0,s.jsxs)("span",{children:["Best session:"," ",(0,s.jsxs)("span",{className:"text-emerald-400 font-semibold",children:[c," bags"]})]}),n[2]=a):a=n[2],n[3]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[e,l,(0,s.jsxs)("div",{className:"mt-4 flex items-center justify-between text-[11px] text-gray-400",children:[a,(0,s.jsxs)("span",{children:["Average:"," ",(0,s.jsxs)("span",{className:"text-emerald-400 font-semibold",children:[o.toFixed(1)," bags"]})]})]})]}),n[3]=r):r=n[3],r}function m(e,s){return e+s}function p(e){let l,a,r,n,d,i,c,o,x,m,p,g=(0,t.c)(30),{data:f,labels:j}=e,y=Math.max(...f,1);if(g[0]!==f||g[1]!==y){let e;g[9]!==f.length||g[10]!==y?(e=(e,s)=>({x:f.length>1?260/(f.length-1)*s:130,y:80-e/y*64-8}),g[9]=f.length,g[10]=y,g[11]=e):e=g[11];let t=f.map(e),o=t.map(b).join(" "),x=o+` L${t[t.length-1]?.x??260},80 L${t[0]?.x??0},80 Z`;c="w-full",l="0 0 260 80",a="w-full h-24 overflow-visible",g[12]===Symbol.for("react.memo_cache_sentinel")?(r=(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"impactGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"0%",stopColor:"#22c55e",stopOpacity:"0.5"}),(0,s.jsx)("stop",{offset:"100%",stopColor:"#22c55e",stopOpacity:"0"})]})}),g[12]=r):r=g[12],g[13]!==x?(n=(0,s.jsx)("path",{d:x,fill:"url(#impactGradient)",stroke:"none",opacity:.6}),g[13]=x,g[14]=n):n=g[14],d=(0,s.jsx)("path",{d:o,fill:"none",stroke:"#22c55e",strokeWidth:2.2,strokeLinecap:"round",strokeLinejoin:"round"}),i=t.map(u),g[0]=f,g[1]=y,g[2]=l,g[3]=a,g[4]=r,g[5]=n,g[6]=d,g[7]=i,g[8]=c}else l=g[2],a=g[3],r=g[4],n=g[5],d=g[6],i=g[7],c=g[8];return g[15]!==l||g[16]!==a||g[17]!==r||g[18]!==n||g[19]!==d||g[20]!==i?(o=(0,s.jsxs)("svg",{viewBox:l,className:a,children:[r,n,d,i]}),g[15]=l,g[16]=a,g[17]=r,g[18]=n,g[19]=d,g[20]=i,g[21]=o):o=g[21],g[22]!==j?(x=j.map(h),g[22]=j,g[23]=x):x=g[23],g[24]!==x?(m=(0,s.jsx)("div",{className:"mt-1 flex justify-between text-[10px] text-gray-500",children:x}),g[24]=x,g[25]=m):m=g[25],g[26]!==m||g[27]!==c||g[28]!==o?(p=(0,s.jsxs)("div",{className:c,children:[o,m]}),g[26]=m,g[27]=c,g[28]=o,g[29]=p):p=g[29],p}function h(e){return(0,s.jsx)("span",{children:e},e)}function u(e,t){return(0,s.jsx)("circle",{cx:e.x,cy:e.y,r:3,fill:"#22c55e",stroke:"#022c22",strokeWidth:1.4},t)}function b(e,s){return`${0===s?"M":"L"}${e.x},${e.y}`}function g(e){let l,a,r,n,d,i=(0,t.c)(12),{label:c,desc:o,icon:x}=e;return i[0]!==x?(l=(0,s.jsx)("span",{className:"text-lg",children:x}),i[0]=x,i[1]=l):l=i[1],i[2]!==c?(a=(0,s.jsx)("p",{className:"font-semibold text-gray-100",children:c}),i[2]=c,i[3]=a):a=i[3],i[4]!==o?(r=(0,s.jsx)("p",{className:"text-gray-400",children:o}),i[4]=o,i[5]=r):r=i[5],i[6]!==a||i[7]!==r?(n=(0,s.jsxs)("div",{className:"text-[11px]",children:[a,r]}),i[6]=a,i[7]=r,i[8]=n):n=i[8],i[9]!==l||i[10]!==n?(d=(0,s.jsxs)("div",{className:"flex items-start gap-2 bg-[#020617] border border-[#1e293b] rounded-xl px-3 py-2",children:[l,n]}),i[9]=l,i[10]=n,i[11]=d):d=i[11],d}e.s(["default",()=>c])}]);