{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/gavrilbogdan/Documents/GitHub/CleanTM/marian/Untitled/my-project/app/api/auth/signup/route.js"],"sourcesContent":["import prisma from \"../../../lib/prisma\";\nimport bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport { NextResponse } from \"next/server\";\n\nconst SALT = 12;\nconst JWT_SECRET = process.env.JWT_SECRET;\nconst JWT_EXPIRES_IN = process.env.JWT_EXPIRES_IN || \"7d\";\n\nexport async function POST(req) {\n  try {\n    const { email, password } = await req.json();\n    console.log(\"Signup request:\", email, password); // <- log input\n\n    if (!email || !password) {\n      return NextResponse.json(\n        { error: \"Missing email or password\" },\n        { status: 400 }\n      );\n    }\n\n    const existingUser = await prisma.User.findUnique({ where: { email } });\n    console.log(\"Existing user:\", existingUser);\n\n    if (existingUser) {\n      return NextResponse.json(\n        { error: \"Email already in use\" },\n        { status: 409 }\n      );\n    }\n\n    const hashedPassword = await bcrypt.hash(password, 12);\n    console.log(\"Hashed password:\", hashedPassword);\n\n    const user = await prisma.user.create({\n      data: { email, password: hashedPassword },\n    });\n\n    console.log(\"User created:\", user);\n\n    const token = jwt.sign(\n      { id: user.id, email: user.email },\n      process.env.JWT_SECRET,\n      { expiresIn: process.env.JWT_EXPIRES_IN }\n    );\n\n    const res = NextResponse.json(\n      { user: { id: user.id, email: user.email } },\n      { status: 201 }\n    );\n    res.headers.set(\n      \"Set-Cookie\",\n      `token=${token}; HttpOnly; Path=/; Max-Age=${\n        7 * 24 * 60 * 60\n      }; SameSite=Strict; Secure=${process.env.NODE_ENV === \"production\"}`\n    );\n\n    return res;\n  } catch (error) {\n    console.error(\"Signup error:\", error); // <- log the real error\n    return NextResponse.json(\n      { error: \"Internal server error\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,OAAO;AACb,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AACzC,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI;AAE9C,eAAe,KAAK,GAAG;IAC5B,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;QAC1C,QAAQ,GAAG,CAAC,mBAAmB,OAAO,WAAW,eAAe;QAEhE,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA4B,GACrC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,eAAe,MAAM,iIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QACrE,QAAQ,GAAG,CAAC,kBAAkB;QAE9B,IAAI,cAAc;YAChB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,iBAAiB,MAAM,8IAAM,CAAC,IAAI,CAAC,UAAU;QACnD,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,MAAM,OAAO,MAAM,iIAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACpC,MAAM;gBAAE;gBAAO,UAAU;YAAe;QAC1C;QAEA,QAAQ,GAAG,CAAC,iBAAiB;QAE7B,MAAM,QAAQ,kJAAG,CAAC,IAAI,CACpB;YAAE,IAAI,KAAK,EAAE;YAAE,OAAO,KAAK,KAAK;QAAC,GACjC,QAAQ,GAAG,CAAC,UAAU,EACtB;YAAE,WAAW,QAAQ,GAAG,CAAC,cAAc;QAAC;QAG1C,MAAM,MAAM,gJAAY,CAAC,IAAI,CAC3B;YAAE,MAAM;gBAAE,IAAI,KAAK,EAAE;gBAAE,OAAO,KAAK,KAAK;YAAC;QAAE,GAC3C;YAAE,QAAQ;QAAI;QAEhB,IAAI,OAAO,CAAC,GAAG,CACb,cACA,CAAC,MAAM,EAAE,MAAM,4BAA4B,EACzC,IAAI,KAAK,KAAK,GACf,0BAA0B,EAAE,oDAAyB,cAAc;QAGtE,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB,QAAQ,wBAAwB;QAC/D,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}