{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/gavrilbogdan/Documents/GitHub/CleanTM/marian/Untitled/my-project/components/Tasks.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useEffect } from \"react\";\n\nconst SIX_HOURS = 6 * 60 * 60 * 1000;\nconst THIRTY_MINUTES = 30 * 60 * 1000;\n\nconst initialTasks = [\n  {\n    id: 1,\n    title: \"Collect 10 plastic bottles\",\n    description: \"Find and collect 10 bottles from your area.\",\n    images: [],\n    lastCompleted: null,\n    startedAt: null,\n  },\n  {\n    id: 2,\n    title: \"Clean a park bench\",\n    description: \"Wipe down and clean a park bench thoroughly.\",\n    images: [],\n    lastCompleted: null,\n    startedAt: null,\n  },\n  {\n    id: 3,\n    title: \"Pick up 15 pieces of trash\",\n    description: \"Collect 15 random pieces of trash.\",\n    images: [],\n    lastCompleted: null,\n    startedAt: null,\n  },\n];\n\nexport default function TasksPage() {\n  const [tasks, setTasks] = useState([]);\n  const [activeTaskId, setActiveTaskId] = useState(null);\n\n  // Load persisted data\n  useEffect(() => {\n    const saved = JSON.parse(localStorage.getItem(\"tasks_v3\"));\n    const active = JSON.parse(localStorage.getItem(\"active_task\"));\n\n    if (saved) setTasks(saved);\n    else {\n      setTasks(initialTasks);\n      localStorage.setItem(\"tasks_v3\", JSON.stringify(initialTasks));\n    }\n\n    if (active) setActiveTaskId(active);\n  }, []);\n\n  useEffect(() => {\n    if (tasks.length > 0)\n      localStorage.setItem(\"tasks_v3\", JSON.stringify(tasks));\n\n    localStorage.setItem(\"active_task\", JSON.stringify(activeTaskId));\n  }, [tasks, activeTaskId]);\n\n  /* ========================= HELPERS ========================= */\n\n  const isCooldown = (task) => {\n    if (!task.lastCompleted) return false;\n    return Date.now() - task.lastCompleted < SIX_HOURS;\n  };\n\n  const getCooldownTime = (task) => {\n    const remaining = SIX_HOURS - (Date.now() - task.lastCompleted);\n    const h = Math.floor(remaining / 3600000);\n    const m = Math.floor((remaining % 3600000) / 60000);\n    return `${h}h ${m}m`;\n  };\n\n  const getFinishUnlockTime = (task) => {\n    if (!task.startedAt) return null;\n    const remaining = THIRTY_MINUTES - (Date.now() - task.startedAt);\n    const m = Math.max(0, Math.floor(remaining / 60000));\n    const s = Math.max(0, Math.floor((remaining % 60000) / 1000));\n    return `${m}m ${s}s`;\n  };\n\n  const startTask = (taskId) => {\n    if (activeTaskId) return; // only allow one active\n    setActiveTaskId(taskId);\n\n    setTasks((prev) =>\n      prev.map((t) => (t.id === taskId ? { ...t, startedAt: Date.now() } : t))\n    );\n  };\n\n  const uploadImage = (taskId, file) => {\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setTasks((prev) =>\n        prev.map((t) =>\n          t.id === taskId ? { ...t, images: [...t.images, reader.result] } : t\n        )\n      );\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const finishTask = (taskId) => {\n    setTasks((prev) =>\n      prev.map((t) =>\n        t.id === taskId\n          ? {\n              ...t,\n              lastCompleted: Date.now(),\n              startedAt: null,\n              images: [],\n            }\n          : t\n      )\n    );\n    setActiveTaskId(null);\n  };\n\n  /* ========================= UI ========================= */\n\n  return (\n    <div className=\"min-h-screen bg-[#050505] px-6 py-16 text-white\">\n      <h1 className=\"text-5xl font-extrabold text-center mb-14 text-green-500 drop-shadow-[0_0_15px_#00ff91]\">\n        Daily CleanTM Tasks\n      </h1>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-12 max-w-7xl mx-auto\">\n        {tasks.map((task) => {\n          const cooldown = isCooldown(task);\n          const isActive = activeTaskId === task.id;\n          const someTaskActive = activeTaskId && !isActive;\n          const canFinish =\n            isActive && Date.now() - task.startedAt >= THIRTY_MINUTES;\n\n          return (\n            <div\n              key={task.id}\n              className=\"\n                rounded-3xl p-6 bg-[#0a0a0a] border border-green-700/40 \n                shadow-[0_0_25px_5px_rgba(0,255,150,0.08)]\n                hover:shadow-[0_0_35px_10px_rgba(0,255,150,0.15)]\n                transition-all duration-500 flex flex-col justify-between\n              \"\n            >\n              <div>\n                <h2 className=\"text-2xl font-bold text-green-400 drop-shadow-sm\">\n                  {task.title}\n                </h2>\n                <p className=\"text-gray-300 mt-3\">{task.description}</p>\n\n                {/* IMAGES */}\n                {task.images.length > 0 && (\n                  <div className=\"flex flex-wrap mt-4 gap-2\">\n                    {task.images.map((img, i) => (\n                      <img\n                        key={i}\n                        src={img}\n                        className=\"h-20 w-20 rounded-xl border border-green-600 object-cover\"\n                      />\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              {/* STATUS */}\n              <div className=\"mt-6\">\n                {cooldown ? (\n                  <p className=\"text-red-400 font-bold text-center\">\n                    Refreshes in {getCooldownTime(task)}\n                  </p>\n                ) : isActive ? (\n                  <p className=\"text-yellow-400 font-semibold text-center\">\n                    Finish unlocked in {getFinishUnlockTime(task)}\n                  </p>\n                ) : someTaskActive ? (\n                  <p className=\"text-gray-400 text-center text-sm\">\n                    Another task is in progress...\n                  </p>\n                ) : null}\n              </div>\n\n              {/* UPLOAD */}\n              {!cooldown && isActive && (\n                <div className=\"mt-4\">\n                  <input\n                    type=\"file\"\n                    onChange={(e) => uploadImage(task.id, e.target.files[0])}\n                    className=\"block w-full text-sm text-green-200 file:bg-green-600 file:text-white file:px-4 file:py-2 file:rounded-full cursor-pointer\"\n                  />\n                </div>\n              )}\n\n              {/* BUTTONS */}\n              <div className=\"mt-6\">\n                {!cooldown && !isActive && !someTaskActive && (\n                  <button\n                    onClick={() => startTask(task.id)}\n                    className=\"\n                      w-full bg-green-600 hover:bg-green-700 \n                      text-white py-2.5 rounded-full font-bold \n                      transition shadow-lg\n                    \"\n                  >\n                    Start Task\n                  </button>\n                )}\n\n                {isActive && (\n                  <button\n                    disabled={!canFinish}\n                    onClick={() => finishTask(task.id)}\n                    className={`\n                      w-full py-2.5 rounded-full font-bold transition shadow-lg\n                      ${\n                        canFinish\n                          ? \"bg-green-500 hover:bg-green-600\"\n                          : \"bg-gray-600 cursor-not-allowed\"\n                      }\n                    `}\n                  >\n                    Finish Task\n                  </button>\n                )}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}