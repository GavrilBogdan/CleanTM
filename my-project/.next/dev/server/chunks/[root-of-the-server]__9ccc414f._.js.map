{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///Users/gavrilbogdan/Documents/GitHub/CleanTM/marian/Untitled/my-project/lib/prisma.js"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\n// Create a single Prisma Client instance\nconst prisma = global.prisma || new PrismaClient();\n\n// Prevent creating multiple instances during development (hot reloads)\nif (process.env.NODE_ENV === \"development\") global.prisma = prisma;\n\nexport default prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,yCAAyC;AACzC,MAAM,SAAS,yDAAO,MAAM,IAAI,IAAI,6IAAY;AAEhD,uEAAuE;AACvE,wCAA4C,yDAAO,MAAM,GAAG;uCAE7C"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///Users/gavrilbogdan/Documents/GitHub/CleanTM/marian/Untitled/my-project/app/api/profile/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport jwt from \"jsonwebtoken\";\nimport prisma from \"@/lib/prisma\";\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key\";\n\n// Get userId from JWT cookie\nfunction getUserIdFromRequest(req) {\n  try {\n    const cookieHeader = req.headers.get(\"cookie\") || \"\";\n    const match = cookieHeader.match(/token=([^;]+)/);\n    if (!match) return null;\n\n    const token = match[1];\n    const decoded = jwt.verify(token, JWT_SECRET);\n\n    return decoded.userId;\n  } catch (err) {\n    console.error(\"getUserIdFromRequest error\", err);\n    return null;\n  }\n}\n\n// GET /api/profile  → return current user profile\nexport async function GET(req) {\n  const userId = getUserIdFromRequest(req);\n  if (!userId) {\n    return NextResponse.json({ user: null }, { status: 401 });\n  }\n\n  const user = await prisma.user.findUnique({\n    where: { id: userId },\n    select: {\n      id: true,\n      email: true,\n      points: true,\n      username: true,\n      avatarUrl: true,\n    },\n  });\n\n  if (!user) {\n    return NextResponse.json({ user: null }, { status: 404 });\n  }\n\n  return NextResponse.json({ user });\n}\n\n// PUT /api/profile  → update username / avatarUrl\nexport async function PUT(req) {\n  try {\n    const userId = getUserIdFromRequest(req);\n    if (!userId) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    const body = await req.json();\n    const { username, avatarUrl } = body;\n\n    const updated = await prisma.user.update({\n      where: { id: userId },\n      data: {\n        ...(username !== undefined ? { username } : {}),\n        ...(avatarUrl !== undefined ? { avatarUrl } : {}),\n      },\n      select: {\n        id: true,\n        email: true,\n        points: true,\n        username: true,\n        avatarUrl: true,\n      },\n    });\n\n    return NextResponse.json({ user: updated });\n  } catch (err) {\n    console.error(\"PUT /api/profile error\", err);\n    return NextResponse.json(\n      { error: \"Internal Server Error\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAE7C,6BAA6B;AAC7B,SAAS,qBAAqB,GAAG;IAC/B,IAAI;QACF,MAAM,eAAe,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa;QAClD,MAAM,QAAQ,aAAa,KAAK,CAAC;QACjC,IAAI,CAAC,OAAO,OAAO;QAEnB,MAAM,QAAQ,KAAK,CAAC,EAAE;QACtB,MAAM,UAAU,kJAAG,CAAC,MAAM,CAAC,OAAO;QAElC,OAAO,QAAQ,MAAM;IACvB,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO;IACT;AACF;AAGO,eAAe,IAAI,GAAG;IAC3B,MAAM,SAAS,qBAAqB;IACpC,IAAI,CAAC,QAAQ;QACX,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,MAAM;QAAK,GAAG;YAAE,QAAQ;QAAI;IACzD;IAEA,MAAM,OAAO,MAAM,0HAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACxC,OAAO;YAAE,IAAI;QAAO;QACpB,QAAQ;YACN,IAAI;YACJ,OAAO;YACP,QAAQ;YACR,UAAU;YACV,WAAW;QACb;IACF;IAEA,IAAI,CAAC,MAAM;QACT,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,MAAM;QAAK,GAAG;YAAE,QAAQ;QAAI;IACzD;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE;IAAK;AAClC;AAGO,eAAe,IAAI,GAAG;IAC3B,IAAI;QACF,MAAM,SAAS,qBAAqB;QACpC,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG;QAEhC,MAAM,UAAU,MAAM,0HAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACvC,OAAO;gBAAE,IAAI;YAAO;YACpB,MAAM;gBACJ,GAAI,aAAa,YAAY;oBAAE;gBAAS,IAAI,CAAC,CAAC;gBAC9C,GAAI,cAAc,YAAY;oBAAE;gBAAU,IAAI,CAAC,CAAC;YAClD;YACA,QAAQ;gBACN,IAAI;gBACJ,OAAO;gBACP,QAAQ;gBACR,UAAU;gBACV,WAAW;YACb;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,MAAM;QAAQ;IAC3C,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}