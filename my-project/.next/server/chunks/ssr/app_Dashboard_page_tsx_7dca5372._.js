module.exports=[9478,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);let e=[{id:1,title:"Bega riverside plastic cleanup",desc:"Gathered PET bottles and cans along the river.",date:"2025-11-10",bags:4,pos:{lat:45.7489,lng:21.229}},{id:2,title:"Neighborhood park trash sweep",desc:"Cleaned snack wrappers and cigarette butts around benches.",date:"2025-11-05",bags:3,pos:{lat:45.7545,lng:21.22}},{id:3,title:"Street-side bottle collection",desc:"Focused on glass bottles near the tram station.",date:"2025-11-01",bags:2,pos:{lat:45.742,lng:21.24}},{id:4,title:"Green area micro-cleanup",desc:"Removed mixed waste from a small green strip.",date:"2025-10-28",bags:1,pos:{lat:45.761,lng:21.205}}],f=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],g=[3,6,2,5,4,7,6];function h(){let a=(0,d.useRouter)(),[f,g]=(0,c.useState)(null),[h,k]=(0,c.useState)(!0),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/profile"),b=await a.json();b.user&&(g(b.user),t(b.user.username||""),v(b.user.avatarUrl||""))}catch(a){console.error("Error loading profile:",a),p("Failed to load profile.")}finally{k(!1)}})()},[]);let w=async()=>{if(f){n(!0),p(null),r(null);try{let a=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s.trim()||null,avatarUrl:u.trim()||null})}),b=await a.json();a.ok?b.user&&(g(b.user),r("Profile saved successfully.")):p(b.error||"Failed to save profile.")}catch(a){console.error("Error saving profile:",a),p("Something went wrong while saving.")}finally{n(!1),setTimeout(()=>r(null),2500)}}},x=f?.username||f?.email?.split("@")[0]||"Eco Explorer",y=f?.username?`@${f.username}`:f?.email?`@${f.email.split("@")[0]}`:"@eco.explorer",z=f?.avatarUrl&&f.avatarUrl.length>0?f.avatarUrl:"/images/rafa.jpg",A=f?.points??0;return h?(0,b.jsx)("div",{className:"min-h-screen bg-[#020617] text-white flex items-center justify-center",children:(0,b.jsx)("p",{className:"text-sm text-gray-300",children:"Loading profileâ€¦"})}):f?(0,b.jsx)("div",{className:"min-h-screen bg-[#020617] text-white px-6 py-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto space-y-8",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Profile"}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Track your cleanup impact, badges and latest missions on the map."})]}),(0,b.jsxs)("button",{onClick:()=>a.back(),className:" self-start sm:self-auto inline-flex items-center gap-2 px-4 py-2 rounded-full text-xs font-semibold bg-[#020617] border border-emerald-500/50 text-emerald-200 hover:bg-emerald-600/10 hover:border-emerald-400 transition ",children:[(0,b.jsx)("span",{className:"text-sm",children:"â†"}),"Back to last page"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-6 lg:col-span-1",children:[(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-20 h-20 rounded-2xl overflow-hidden border-2 border-emerald-400 shadow-[0_0_25px_rgba(16,185,129,0.65)]",children:(0,b.jsx)("img",{src:z,alt:x,className:"w-full h-full object-cover"})}),(0,b.jsxs)("div",{className:"absolute -bottom-1 -right-1 px-2 py-0.5 rounded-full bg-emerald-500 text-[11px] font-semibold",children:["Lv. ",7]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-lg font-semibold",children:x}),(0,b.jsx)("p",{className:"text-xs text-gray-400",children:y}),(0,b.jsxs)("p",{className:"mt-2 text-xs text-emerald-400 flex items-center gap-1",children:[(0,b.jsx)("span",{className:"text-base",children:"ðŸ’Ž"}),(0,b.jsxs)("span",{className:"font-semibold",children:[A," eco points"]})]})]})]}),(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-3 text-center text-xs",children:[(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl py-3",children:[(0,b.jsx)("p",{className:"text-gray-400 mb-1",children:"Global rank"}),(0,b.jsxs)("p",{className:"text-lg font-bold text-white",children:["#",12]})]}),(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl py-3",children:[(0,b.jsx)("p",{className:"text-gray-400 mb-1",children:"Cleanups"}),(0,b.jsx)("p",{className:"text-lg font-bold text-emerald-400",children:34})]}),(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl py-3",children:[(0,b.jsx)("p",{className:"text-gray-400 mb-1",children:"Hours"}),(0,b.jsx)("p",{className:"text-lg font-bold text-emerald-400",children:52})]})]})]}),(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,b.jsx)("h2",{className:"text-sm font-semibold mb-3 text-gray-100",children:"Impact overview"}),(0,b.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Total bags collected"}),(0,b.jsx)("span",{className:"font-semibold text-emerald-400",children:96})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Average bags / cleanup"}),(0,b.jsx)("span",{className:"font-semibold",children:"2.8"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Average duration"}),(0,b.jsxs)("span",{className:"font-semibold",children:["1.5"," h"]})]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Progress to next level"}),(0,b.jsx)("div",{className:"h-2 w-full bg-[#020617] border border-[#1e293b] rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-300 rounded-full",style:{width:"68%"}})})]})]}),(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,b.jsx)("h2",{className:"text-sm font-semibold mb-3 text-gray-100",children:"Profile settings"}),(0,b.jsxs)("div",{className:"space-y-3 text-xs",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-gray-400 mb-1",children:"Username (public)"}),(0,b.jsx)("input",{type:"text",value:s,onChange:a=>t(a.target.value),placeholder:"Your public username",className:"w-full bg-[#020617] border border-[#1e293b] rounded-lg px-3 py-2 outline-none text-sm text-gray-100 placeholder:text-gray-500"}),(0,b.jsx)("p",{className:"mt-1 text-[11px] text-gray-500",children:"This will be shown on leaderboards and quests."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-gray-400 mb-1",children:"Avatar image URL"}),(0,b.jsx)("input",{type:"text",value:u,onChange:a=>v(a.target.value),placeholder:"https://your-avatar-url.jpg",className:"w-full bg-[#020617] border border-[#1e293b] rounded-lg px-3 py-2 outline-none text-sm text-gray-100 placeholder:text-gray-500"}),(0,b.jsx)("p",{className:"mt-1 text-[11px] text-gray-500",children:"For now, paste a direct image URL. (Later you can add upload.)"})]}),o&&(0,b.jsx)("p",{className:"text-[11px] text-red-400 mt-1",children:o}),q&&(0,b.jsx)("p",{className:"text-[11px] text-emerald-400 mt-1",children:q}),(0,b.jsx)("button",{onClick:w,disabled:m,className:`mt-2 w-full text-center py-2.5 rounded-full text-sm font-semibold 
                    bg-emerald-600 hover:bg-emerald-500 transition 
                    disabled:opacity-50 disabled:cursor-not-allowed`,children:m?"Savingâ€¦":"Save changes"})]})]}),(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,b.jsx)("h2",{className:"text-sm font-semibold mb-3 text-gray-100",children:"Badges & achievements"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs",children:[(0,b.jsx)(l,{label:"River Guardian",desc:"5+ river cleanups",icon:"ðŸŒŠ"}),(0,b.jsx)(l,{label:"Bottle Hunter",desc:"200+ bottles collected",icon:"ðŸ§´"}),(0,b.jsx)(l,{label:"Weekend Warrior",desc:"Active 4 weekends in a row",icon:"ðŸ“…"}),(0,b.jsx)(l,{label:"Early Supporter",desc:"Joined in beta",icon:"â­"})]})]})]}),(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Last cleanup locations"}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"A quick overview of your most recent cleanup spots."})]}),(0,b.jsxs)("span",{className:"text-[11px] px-2 py-1 rounded-full bg-emerald-500/10 text-emerald-300 border border-emerald-500/40",children:[e.length," locations"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4",children:[(0,b.jsx)("div",{className:"xl:col-span-2",children:(0,b.jsx)(i,{cleanups:e})}),(0,b.jsx)("div",{className:"space-y-3 max-h-[260px] overflow-y-auto pr-1",children:e.map(a=>(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-xl px-3 py-3 text-xs hover:border-emerald-500/70 hover:bg-[#020617]/60 transition",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-[13px]",children:a.title}),(0,b.jsx)("p",{className:"text-gray-400 mt-0.5",children:a.desc})]}),(0,b.jsx)("span",{className:"text-[11px] text-gray-500 whitespace-nowrap",children:a.date})]}),(0,b.jsxs)("div",{className:"mt-2 flex items-center justify-between text-[11px] text-gray-400",children:[(0,b.jsxs)("span",{children:["ðŸ—‘ï¸ ",a.bags," bags collected"]}),(0,b.jsxs)("span",{children:[a.pos.lat.toFixed(3),", ",a.pos.lng.toFixed(3)]})]})]},a.id))})]})]}),(0,b.jsx)(j,{})]})]})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-[#020617] text-white flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("p",{className:"text-lg font-semibold",children:"Youâ€™re not logged in."}),(0,b.jsx)("p",{className:"text-sm text-gray-400",children:"Please log in to view your dashboard."})]})})}function i({cleanups:a}){let d=(0,c.useRef)(null),e=(0,c.useRef)(null),f=(0,c.useRef)(null),g=(0,c.useRef)(null);return(0,c.useEffect)(()=>()=>{e.current&&(e.current.remove(),e.current=null)},[]),(0,c.useEffect)(()=>{if(!e.current||!f.current||!g.current)return;let b=g.current;f.current.clearLayers();let c=[];if(a.forEach(a=>{let d=b.circleMarker([a.pos.lat,a.pos.lng],{radius:7,weight:2,color:"#22c55e",fillColor:"#22c55e",fillOpacity:.8});d.bindPopup(`<strong>${a.title}</strong><br/>${a.desc}<br/><small>${a.date}</small>`),d.addTo(f.current),c.push([a.pos.lat,a.pos.lng])}),c.length>0){let a=b.latLngBounds(c);e.current.fitBounds(a,{padding:[20,20]})}},[a]),(0,b.jsx)("div",{className:"w-full h-[260px] rounded-xl overflow-hidden border border-[#1e293b]",children:(0,b.jsx)("div",{ref:d,className:"w-full h-full"})})}function j(){let a=Math.max(...g),c=g.reduce((a,b)=>a+b,0)/g.length;return(0,b.jsxs)("div",{className:"bg-[#020617] border border-[#1e293b] rounded-2xl p-5 shadow-xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-sm font-semibold text-gray-100",children:"Impact timeline"}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Bags collected across your last 7 cleanups."})]}),(0,b.jsx)("span",{className:"text-[11px] text-gray-500",children:"Last 7 sessions"})]}),(0,b.jsx)(k,{data:g,labels:f}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between text-[11px] text-gray-400",children:[(0,b.jsxs)("span",{children:["Best session:"," ",(0,b.jsxs)("span",{className:"text-emerald-400 font-semibold",children:[a," bags"]})]}),(0,b.jsxs)("span",{children:["Average:"," ",(0,b.jsxs)("span",{className:"text-emerald-400 font-semibold",children:[c.toFixed(1)," bags"]})]})]})]})}function k({data:a,labels:c}){let d=Math.max(...a,1),e=a.map((b,c)=>({x:a.length>1?260/(a.length-1)*c:130,y:80-b/d*64-8})),f=e.map((a,b)=>`${0===b?"M":"L"}${a.x},${a.y}`).join(" "),g=f+` L${e[e.length-1]?.x??260},80 L${e[0]?.x??0},80 Z`;return(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("svg",{viewBox:"0 0 260 80",className:"w-full h-24 overflow-visible",children:[(0,b.jsx)("defs",{children:(0,b.jsxs)("linearGradient",{id:"impactGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,b.jsx)("stop",{offset:"0%",stopColor:"#22c55e",stopOpacity:"0.5"}),(0,b.jsx)("stop",{offset:"100%",stopColor:"#22c55e",stopOpacity:"0"})]})}),(0,b.jsx)("path",{d:g,fill:"url(#impactGradient)",stroke:"none",opacity:.6}),(0,b.jsx)("path",{d:f,fill:"none",stroke:"#22c55e",strokeWidth:2.2,strokeLinecap:"round",strokeLinejoin:"round"}),e.map((a,c)=>(0,b.jsx)("circle",{cx:a.x,cy:a.y,r:3,fill:"#22c55e",stroke:"#022c22",strokeWidth:1.4},c))]}),(0,b.jsx)("div",{className:"mt-1 flex justify-between text-[10px] text-gray-500",children:c.map(a=>(0,b.jsx)("span",{children:a},a))})]})}function l({label:a,desc:c,icon:d}){return(0,b.jsxs)("div",{className:"flex items-start gap-2 bg-[#020617] border border-[#1e293b] rounded-xl px-3 py-2",children:[(0,b.jsx)("span",{className:"text-lg",children:d}),(0,b.jsxs)("div",{className:"text-[11px]",children:[(0,b.jsx)("p",{className:"font-semibold text-gray-100",children:a}),(0,b.jsx)("p",{className:"text-gray-400",children:c})]})]})}a.s(["default",()=>h])}];

//# sourceMappingURL=app_Dashboard_page_tsx_7dca5372._.js.map